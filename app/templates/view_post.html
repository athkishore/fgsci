{% extends "base.html" %}

{% block app_content %}
<div class="container">
  {% if post.title %}
  <h1>{{ post.title }}</h1>
  {% endif %}
  {% autoescape off %}
  {{ post.body }}
  {% endautoescape %}

  {% if post.child_posts.all() %}
  <div class="card">
    <div class="card-header">
      Read more
    </div>
    <ul class="list-group list-group-flush">
      {% for child_post in post.child_posts.all() %}
      <li class="list-group-item"><a href="{{ url_for('view_post', post_slug=child_post.slug) }}">{{ child_post.title }}</a></li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}

  {% if current_user.is_authenticated and current_user.username == 'admin'
  %}
  <p><a href="{{ url_for('edit_post', post_slug=post.slug) }}">Edit post</a></p>
  <p>
  <form action="{{ url_for('delete_post', post_slug=post.slug) }}" method="post"
    onSubmit="return confirm('Are you sure you wish to delete?');"
  >
    {{ form.hidden_tag() }}
    {{ form.submit(value='Delete') }}
  </form>
  </p>
  {% endif %}
</div>
{% endblock %}
